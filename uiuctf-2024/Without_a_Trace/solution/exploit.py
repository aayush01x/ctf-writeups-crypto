import subprocess
import time
from Crypto.Util.number import long_to_bytes
def func(u1,u2,u3,u4,u5):
    process = subprocess.Popen(
        ['ncat', '--ssl', 'without-a-trace.chal.uiuc.tf', '1337'],
        stdin=subprocess.PIPE,
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        text=True
    )
    def req(value, prompt):
        output = ''
        while prompt not in output:
            output += process.stdout.read(1)
        process.stdin.write(f"{value}\n")
        process.stdin.flush()
        return output
    output = req(u1, "[WAT] u1 = ")
    output += req(u2, "[WAT] u2 = ")
    output += req(u3, "[WAT] u3 = ")
    output += req(u4, "[WAT] u4 = ")
    output += req(u5, "[WAT] u5 = ")
    fin= process.stdout.read()
    return int(fin.split('Have fun: ')[-1][:-1])
def main():
    z0 = func(1,1,1,1,1)
    z1 = func(2,1,1,1,1)
    z2 = func(1,2,1,1,1)
    z3 = func(1,1,2,1,1)
    z4 = func(1,1,1,2,1)
    z5 = func(1,1,1,1,2)
    print((long_to_bytes(z1-z0)+long_to_bytes(z2-z0) + long_to_bytes(z3-z0) + long_to_bytes(z4-z0) + long_to_bytes(z5-z0)).decode())
if __name__ == "__main__":
    main()
