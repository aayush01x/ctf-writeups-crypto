`input` function takes input some elements of the matrix from the user. `fun` function returns determinant of the matrix passed. `main` function prints determinant of the user input matrix if its det is non zero.
So, if user inputs are $x_1,x_2,\cdots, x_9$, then constructed matrix will be where $p,q,r$ are imported from SECRET.
$$
\begin{pmatrix}
p & 0 & x_1 & 0 & x_2\\
0 & x_3 & 0 & x_4 & 0\\
x_5 & 0 & x_6 & 0 & x_7\\
0 & q & 0 & r & 0\\
x_8 & 0 & x_9 & 0 & 0
\end{pmatrix}
$$

Determinant of the given matrix is:
$$p q x_4 x_7 x_9 - p r x_3 x_7 x_9 + q x_2 x_4 x_6 x_8 - q x_1 x_4 x_7 x_8 - q x_2 x_4 x_5 x_9 - r x_2 x_3 x_6 x_8 + r x_1 x_3 x_7 x_8 + r x_2 x_3 x_5 x_9$$

$p,q$ are needed in the `gen.py`, so its better if we remove terms containing $r$ from determinant. We can do this by putting $x_3 = 0$, which makes the determinant:
$$x_4 (p q x_7 x_9 + q x_2 x_6 x_8 - q x_1 x_7 x_8 - q x_2 x_5 x_9)$$
We can substitute all other values to be $1$ and we finally get 
$$pq -q$$
But $n = pq$, so by inputting values as above, getting determinant, and knowing $n$, we can obtain $q$. Using it, we can decrypt the RSA.

```
‚ùØ ncat --ssl determined.chal.uiuc.tf 1337
[DET] Welcome
[DET] First things first, gimme some numbers:
[DET] M[0][2] = 1
[DET] M[0][4] = 1
[DET] M[1][1] = 0
[DET] M[1][3] = 1
[DET] M[2][0] = 1
[DET] M[2][2] = 1
[DET] M[2][4] = 1
[DET] M[4][0] = 1
[DET] M[4][2] = 1
[DET] Have fun: 158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993827021237309488607099396251558718631178638562077858262514078537543492352337967199580389883367433729078970596973723167029400868564841912135610784434189991222
```
So, we get the value of determinant `158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993827021237309488607099396251558718631178638562077858262514078537543492352337967199580389883367433729078970596973723167029400868564841912135610784434189991222`

**exploit.py**
```python
from Crypto.Util.number import long_to_bytes
n = 158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993839560087229636799779157903650823700424848036276986652311165197569877428810358366358203174595667453056843209344115949077094799081260298678936223331932826351
e = 65535
c = 72186625991702159773441286864850566837138114624570350089877959520356759693054091827950124758916323653021925443200239303328819702117245200182521971965172749321771266746783797202515535351816124885833031875091162736190721470393029924557370228547165074694258453101355875242872797209141366404264775972151904835111
det_obtained = 158794636700752922781275926476194117856757725604680390949164778150869764326023702391967976086363365534718230514141547968577753309521188288428236024251993827021237309488607099396251558718631178638562077858262514078537543492352337967199580389883367433729078970596973723167029400868564841912135610784434189991222
q = n - det_obtained
p = (n+q-1)//q
phi = (p-1)*(q-1)
d = pow(e,-1,phi)
m = pow(c,d,n)
print(long_to_bytes(m).decode())
```

**Flag**:`uiuctf{h4rd_w0rk_&&_d3t3rm1n4t10n}`